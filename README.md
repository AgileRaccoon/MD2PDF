# Markdown to PDF Converter

MarkdownファイルをPDFに変換するGUIアプリケーションです。編集機能とプレビュー機能を統合し、効率的なドキュメント作成環境を提供します。

## 機能概要

- ドラッグ&ドロップによるファイル読み込み
- 統合Markdownエディタ（リアルタイムプレビュー付き）
- 新規ファイル作成機能
- 複数ファイルの一括変換
- Mermaidダイアグラム対応
- 改ページ制御
- 目次生成
- 3分割レイアウト（設定・エディタ・プレビュー）

## セットアップ

### 実行環境

- Python 3.8以上
- Windows/macOS/Linux

### インストール

```bash
pip install -r requirements.txt
```

### 起動

```bash
python MD2PDF.py
```

## 使用方法

### 基本操作

1. アプリケーションを起動
2. ファイルの読み込み：
   - ドラッグ&ドロップ
   - 「📁 ファイル選択」ボタン
   - 「📝 新規作成」ボタン
3. 中央のエディタでMarkdownを編集
4. 💾ボタンで保存
5. 出力フォルダを指定し、「PDFに変換」をクリック

### 新規作成

1. 「📝 新規作成」ボタンをクリック
2. ファイル名を入力
3. テンプレートが自動挿入され、編集開始
4. 💾ボタンで名前を付けて保存

### エディタ機能

- リアルタイムプレビュー
- 保存機能（💾ボタン）
- 再読込機能（🔄ボタン）
- 一時ファイル管理

### ファイル管理

- 複数ファイル選択
- 個別削除（×ボタン）
- 一括クリア（🗑ボタン）
- ファイル切り替え
- テキストファイル対応

### プレビュー機能

- ズーム調整（30%〜300%）
- ファイル切り替え（◀▶ボタン）
- ページ表示
- リアルタイム更新

### 改ページ

改ページしたい位置に以下を挿入：

```markdown
<!-- pagebreak -->
```

カスタムマーカーも設定可能です。

## UI構成

### 3分割レイアウト

1. **左パネル（設定）**
   - ファイル操作ボタン
   - ドラッグ&ドロップエリア
   - ファイルリスト
   - 出力設定
   - 変換オプション

2. **中央パネル（エディタ）**
   - Markdownエディタ
   - 保存・再読込ボタン

3. **右パネル（プレビュー）**
   - HTMLプレビュー
   - ズーム・ページ制御

## 技術仕様

### 使用ライブラリ

- PyQt5 - GUIフレームワーク
- PyQtWebEngine - HTMLレンダリング・PDF生成
- Markdown - Markdown処理
- Pygments - シンタックスハイライト
- Mermaid.js - ダイアグラム生成

### 処理フロー

1. Markdown → HTML変換
2. リアルタイムプレビュー
3. ファイル管理
4. PDF生成
5. UI制御

## トラブルシューティング

### Windows Defender警告
exe版実行時に警告が出る場合：
1. 「詳細情報」をクリック
2. 「実行」をクリック

### Mermaidが表示されない
- インターネット接続を確認
- コードブロックの言語指定が`mermaid`になっているか確認

### 日本語の文字化け
- ファイルの文字コードがUTF-8であることを確認

### 変換エラー
- 複数ファイル変換時はエラーファイルをスキップして処理継続
- 変換完了時にエラーレポートを表示

## 制限事項

- 外部画像はローカル画像のみサポート
- カスタムCSSは未サポート
- ページサイズはA4固定
- 大容量ファイルではパフォーマンス低下の可能性